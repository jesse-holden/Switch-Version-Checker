<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Check Current Nintendo Switch Firmware Version</title>
    <style>
        body {
            text-align: center;
            font-weight: bold;
            font-family: sans-serif;
        }

        h1 {
            font-size: 2em;
            margin-top: 1em;
        }

        .version-text {
            font-size: 3em;
            font-weight: bold;
        }
        
        .age-text {
            font-size: 1.2em;
            margin-top: 10px;
        }

        footer {
            text-align: center;
            margin-top: 100px;
        }
    </style>
</head>

<body>
<h1>What is the newest/current firmware version being pushed out to Nintendo Switch systems?</h1>
<div style="display: flex; justify-content: center; gap: 50px; flex-wrap: wrap;">
    <div>
        <h2>Switch</h2>
        <p id="switch-version" class="version-text" title="According to yellows8's page">Checking...</p>
        <p id="switch-age" class="age-text">Checking...</p>
    </div>
    <div>
        <h2>Switch 2</h2>
        <p id="switch2-version" class="version-text" title="According to yellows8's page">Checking...</p>
        <p id="switch2-age" class="age-text">Checking...</p>
    </div>
</div>
<footer>Useful links
    <br/>
    <a href="https://www.reddit.com/r/SwitchHaxing/comments/5z21np/nintendo_switch_official_hacking_guide/">Switch
        Hacking Guide</a> --
    <a href="https://www.reddit.com/r/SwitchHaxing/">Reddit</a> --
    <a href="https://yls8.mtheall.com/ninupdates/reports.php">Powered by yellows8</a>
</footer>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-dateFormat/1.0/jquery.dateFormat.js"></script>
<script>
    jQuery(document).ready(function ($) {
        setTimeout(function () {
            var COLORS = [
                '#e21400', '#91580f', '#f8a700', '#f78b00',
                '#58dc00', '#287b00', '#a8f07a', '#4ae8c4',
                '#3b88eb', '#3824aa', '#a700ff', '#d300e7'
            ];

            function getVersionColor(version) {
                // Compute hash code
                var hash = 7;
                for (var i = 0; i < version.length; i++) {
                    hash = version.charCodeAt(i) + (hash << 5) - hash;
                }
                // Calculate color
                var index = Math.abs(hash % COLORS.length);
                return COLORS[index];
            }

            $.ajax({
                url: 'https://api.rss2json.com/v1/api.json',
                method: 'GET',
                dataType: 'json',
                data: {
                    rss_url: 'https://yls8.mtheall.com/ninupdates/feed.php',
                    api_key: 'njke4g4qls3gbcn9zq90cbs2fzimry3zwnbssvsm'
                }
            }).done(function (data) {
                function parseDateFromPubDate(pubDate) {
                    var dateTimeParts = pubDate.split(" ");
                    var timeParts = dateTimeParts[1].split(':');
                    var dateParts = dateTimeParts[0].split('-');
                    return new Date(dateParts[0], parseInt(dateParts[1], 10) - 1, dateParts[2], timeParts[0], timeParts[1]);
                }

                function updateVersionDisplay(versionSelector, ageSelector, version, date) {
                    if (version) {
                        $(versionSelector).text(version).css("color", getVersionColor(version));
                        var $ageElement = $(ageSelector);
                        $ageElement.html("~" + $.format.prettyDate(date) + "<br />");
                        $ageElement.append("(" + $.format.date(date, "MMM D yyyy @ h:mm a") + " UTC)");
                    } else {
                        $(versionSelector).text("N/A");
                        $(ageSelector).text("No updates found");
                    }
                }

                var switchVersion = null;
                var switch2Version = null;
                var switchDate = null;
                var switch2Date = null;

                // Find the latest versions for both Switch and Switch 2
                $.each(data.items, function (k, v) {
                    var title = v.title;
                    if (title.indexOf("Switch 2 ") === 0 && !switch2Version) {
                        switch2Version = title.split(" ")[2];
                        switch2Date = parseDateFromPubDate(v.pubDate);
                    } else if (title.indexOf("Switch ") === 0 && title.indexOf("Switch 2 ") !== 0 && !switchVersion) {
                        switchVersion = title.split(" ")[1];
                        switchDate = parseDateFromPubDate(v.pubDate);
                    }
                });

                // Update both versions
                updateVersionDisplay('#switch-version', '#switch-age', switchVersion, switchDate);
                updateVersionDisplay('#switch2-version', '#switch2-age', switch2Version, switch2Date);
            });
        }, 50);
    });
</script>

</html>
